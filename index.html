<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>Ø³Ø¬Ù„ Ù…Ø´ÙˆØ±Ø© Ø§Ù„Ø£Ø·ÙØ§Ù„</title>
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</head>
<body dir="rtl" style="font-family: Arial; padding: 30px">

  <h2>Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ù…Ù‡Ø§Øª</h2>

  <form id="momForm">
    <label>Ø§Ø³Ù… Ø§Ù„Ø£Ù…:</label><br />
    <input type="text" id="name" required><br /><br />

    <label>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ:</label><br />
    <input type="text" id="nid" required><br /><br />

    <label>Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„:</label><br />
    <input type="text" id="phone" required><br /><br />

    <button type="submit">â• Ø¥Ø¶Ø§ÙØ©</button>
  </form>

  <br />
  <button id="downloadBtn" style="display:none;">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Excel</button>

  <h3>ğŸ“ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ø®Ù„Ø©:</h3>
  <ul id="dataList"></ul>

  <script>
    const dataList = [];
    const listElement = document.getElementById("dataList");
    const form = document.getElementById("momForm");
    const downloadBtn = document.getElementById("downloadBtn");

    form.addEventListener("submit", function (e) {
      e.preventDefault();

      const name = document.getElementById("name").value.trim();
      const nid = document.getElementById("nid").value.trim();
      const phone = document.getElementById("phone").value.trim();

      if (!name || !nid || !phone) {
        alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
        return;
      }

      // Ø£Ø¶Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…ØµÙÙˆÙØ©
      dataList.push([name, nid, phone]);

      // Ø£Ø¶Ù Ù„Ù„ÙˆØ§Ø¬Ù‡Ø©
      const li = document.createElement("li");
      li.textContent = `ğŸ‘©â€ğŸ¦± ${name} | ğŸªª ${nid} | ğŸ“± ${phone}`;
      listElement.appendChild(li);

      // Ø£Ø¸Ù‡Ø± Ø²Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
      downloadBtn.style.display = "inline-block";

      // Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„
      form.reset();
    });

    downloadBtn.addEventListener("click", function () {
      const headers = ["Ø§Ø³Ù… Ø§Ù„Ø£Ù…", "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ", "Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"];
      const ws_data = [headers, ...dataList];

      const worksheet = XLSX.utils.aoa_to_sheet(ws_data);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, "Ø³Ø¬Ù„ Ù…Ø´ÙˆØ±Ø© Ø§Ù„Ø£Ø·ÙØ§Ù„");

      const wbout = XLSX.write(workbook, { bookType: "xlsx", type: "array" });
      const blob = new Blob([wbout], { type: "application/octet-stream" });

      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "Ø³Ø¬Ù„_Ù…Ø´ÙˆØ±Ø©.xlsx";
      a.click();
    });
  </script>

</body>
</html>
